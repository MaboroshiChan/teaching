<!DOCTYPE html>
<!-- journal -->
<html lang="en-gb"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><style>
.lap {
    text-align: right;
}
</style> 

  
  <meta charset="utf-8">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  
     <title>Implementing Type-Classes as OCaml Modules</title>
  
  <meta name="author" content="ACCU">
  
  
  
  
  <meta name="keywords" content="accu, C++">
  
  
  <meta name="description" content="Type classes achieve overloading in functional paradigms. Shayne Fletcher implements some as OCaml modules.">

  <meta name="generator" content="Hugo 0.74.1">

  
  <link href="Implementing%20Type-Classes%20as%20OCaml%20Modules_files/css.css" rel="stylesheet" type="text/css">

  
  <link rel="stylesheet" href="Implementing%20Type-Classes%20as%20OCaml%20Modules_files/all.css">
  <link rel="stylesheet" href="Implementing%20Type-Classes%20as%20OCaml%20Modules_files/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

  
  <link href="Implementing%20Type-Classes%20as%20OCaml%20Modules_files/animate.css" rel="stylesheet">

  
  
    <link href="Implementing%20Type-Classes%20as%20OCaml%20Modules_files/style.default.css" rel="stylesheet" id="theme-stylesheet">
  

  
  <link href="Implementing%20Type-Classes%20as%20OCaml%20Modules_files/custom.css" rel="stylesheet">

  
  
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
  <link rel="shortcut icon" href="https://accu.org/img/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" href="https://accu.org/img/apple-touch-icon.png">

  
  <link href="Implementing%20Type-Classes%20as%20OCaml%20Modules_files/owl.carousel.css" rel="stylesheet">
  <link href="Implementing%20Type-Classes%20as%20OCaml%20Modules_files/owl.theme.css" rel="stylesheet">

  
  <link rel="alternate" href="https://accu.org/index.xml" type="application/rss+xml" title="ACCU">

  
  
  
  
  
  
  <meta property="og:updated_time" content="2017-12-03T22:27:28Z">
  

  
  <meta name="twitter:card" content="summary">
  
  <meta name="twitter:title" content="Implementing Type-Classes as OCaml Modules">
  
  <meta name="twitter:description" content="Type classes achieve overloading in functional paradigms. Shayne Fletcher implements some as OCaml modules.">
  


  <script>

    <!-- The functions getCookie and checkCookie were copied from
         https:
	-->

    function getCookie ( cname )
    {
        var name          = cname + "=";
        var decodedCookie = decodeURIComponent ( document.cookie );
        var ca            = decodedCookie.split ( ';' );

        for ( var i = 0;   i < ca.length;   i++ )
        {
            var c = ca[ i ];
            while ( c.charAt ( 0 ) == ' ' )
            {
                c = c.substring ( 1 );
            }

            if ( c.indexOf ( name ) == 0 )
            {
                return c.substring ( name.length, c.length );
            }
        }

        return "";
    }

    function checkCookie ()
    {
        var username = getCookie ( "login-name" );

        if ( username != "" )
        {
            document.getElementById ( "login" ).innerHTML   = "Logged in as " + username;
            document.getElementById ( "already" ).innerHTML = username + " is already logged into this session."
        }
        else
        {
            document.getElementById ( "login" ).innerHTML = "";
        }
    }

  </script>

</head>


  <body onload="checkCookie()">

    <div id="all">

        <header>

          
<div id="top">
  <div class="container">
    <div class="row">
      <div class="col-xs-5">

        

        <p id="login"></p>

      </div>

      <div class="col-xs-7">
        <div class="social">
          
          <a href="https://www.twitter.com/accuorg" target="_blank" style="opacity: 1;"><img src="Implementing%20Type-Classes%20as%20OCaml%20Modules_files/twitter.png"></a>
          
          <a href="https://www.facebook.com/accuorg" target="_blank" style="opacity: 1;"><img src="Implementing%20Type-Classes%20as%20OCaml%20Modules_files/facebook.png"></a>
          
          <a href="https://www.linkedin.com/company/accu/" target="_blank" style="opacity: 1;"><img src="Implementing%20Type-Classes%20as%20OCaml%20Modules_files/linkedin.png"></a>
          
          <a href="https://www.github.com/accu-org" target="_blank" style="opacity: 1;"><img src="Implementing%20Type-Classes%20as%20OCaml%20Modules_files/github.png"></a>
          
          <a href="https://www.flickr.com/groups/accu-org" target="_blank" style="opacity: 1;"><img src="Implementing%20Type-Classes%20as%20OCaml%20Modules_files/flickr.png"></a>
          
          <a href="https://www.youtube.com/channel/UCJhay24LTpO1s4bIZxuIqKw" target="_blank" style="opacity: 1;"><img src="Implementing%20Type-Classes%20as%20OCaml%20Modules_files/youtube.png"></a>
          
          <a href="https://discord.com/channels/823242577213128784/823242577213128788" target="_blank" style="opacity: 1;"><img src="Implementing%20Type-Classes%20as%20OCaml%20Modules_files/discord.png"></a>
          
          <a href="https://accu.org/index.xml" target="_blank" style="opacity: 1;"><img src="Implementing%20Type-Classes%20as%20OCaml%20Modules_files/rss.png"></a>
          
        </div>
      </div>
    </div>
  </div>
</div>



          <div class="navbar-affixed-top" data-spy="affix-top" data-offset-top="200">

    <div class="navbar navbar-default yamm" role="navigation" id="navbar">

        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand home" href="https://accu.org/">
                    <img src="Implementing%20Type-Classes%20as%20OCaml%20Modules_files/logo.png" alt="Implementing Type-Classes as OCaml Modules logo" class="hidden-xs hidden-sm">
                    <img src="Implementing%20Type-Classes%20as%20OCaml%20Modules_files/logo-small.png" alt="Implementing Type-Classes as OCaml Modules logo" class="visible-xs visible-sm">
                    <span class="sr-only">Implementing Type-Classes as OCaml Modules - go to homepage</span>
                </a>
                <div class="navbar-buttons">
                    <button type="button" class="navbar-toggle btn-template-main" data-toggle="collapse" data-target="#navigation">
                      <span class="sr-only">Toggle Navigation</span>
                        <i class="fas fa-align-justify"></i>
                    </button>
                </div>
            </div>
            

            <div class="navbar-collapse collapse" id="navigation">
                <ul class="nav navbar-nav navbar-right">
                  
                  
                  
                  <li class="dropdown">
                    
                    <a href="https://accu.org/">Home</a>
                    
                  </li>
                  
                  
                  <li class="dropdown">
                    
                    <a href="https://accu.org/news/">News</a>
                    
                  </li>
                  
                  
                  <li class="dropdown">
                    
                    <a href="https://accu.org/conf-main/main/">Conferences</a>
                    
                  </li>
                  
                  
                  <li class="dropdown">
                    
                      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Videos <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                      
                        <li><a href="https://accu.org/video/online/">ACCU Online</a></li>
                      
                        <li><a href="https://accu.org/video/spring-2022-day-1/">ACCU 2022 Bristol</a></li>
                      
                        <li><a href="https://accu.org/video/spring-2021-preview/">ACCU 2021 Online</a></li>
                      
                        <li><a href="https://accu.org/video/autumn-2019/">ACCU Autumn 2019 Belfast</a></li>
                      
                        <li><a href="https://accu.org/video/spring-2019-day-1/">ACCU 2019 Bristol</a></li>
                      
                        <li><a href="https://accu.org/video/spring-2018-day-1/">ACCU 2018 Bristol</a></li>
                      
                        <li><a href="https://accu.org/video/spring-2017-day-1/">ACCU 2017 Bristol</a></li>
                      
                        <li><a href="https://accu.org/video/spring-2016-day-1/">ACCU 2016 Bristol</a></li>
                      
                        <li><a href="https://accu.org/video/spring-2015/">ACCU 2015 Bristol</a></li>
                      
                        <li><a href="https://accu.org/video/spring-2014/">ACCU 2014 Bristol</a></li>
                      
                        <li><a href="https://accu.org/menu-overviews/all-conferences/">All Conferences</a></li>
                      
                    </ul>
                    
                  </li>
                  
                  
                  <li class="dropdown">
                    
                      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Journals <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                      
                        <li><a href="https://accu.org/menu-overviews/journals-overview/">Journals Overview</a></li>
                      
                        <li><a href="https://accu.org/journals/nonmembers/overload_issue_members/">Overload by Issue</a></li>
                      
                        <li><a href="https://accu.org/journals/nonmembers/overload_article_members/">Overload by Article</a></li>
                      
                        <li><a href="https://accu.org/journals/nonmembers/overload_author_members/">Overload by Author</a></li>
                      
                        <li><a href="https://accu.org/journals/nonmembers/cvu_issue_neutered/">C Vu by Issue</a></li>
                      
                        <li><a href="https://accu.org/journals/nonmembers/cvu_article_neutered/">C Vu by Article</a></li>
                      
                        <li><a href="https://accu.org/journals/nonmembers/cvu_author_neutered/">C Vu by Author</a></li>
                      
                    </ul>
                    
                  </li>
                  
                  
                  <li class="dropdown">
                    
                      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Reviews <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                      
                        <li><a href="https://accu.org/menu-overviews/reviews-overview/">Reviews Overview</a></li>
                      
                        <li><a href="https://accu.org/reviews/by_date/">Reviews by Date</a></li>
                      
                        <li><a href="https://accu.org/reviews/by_title/">Reviews by Title</a></li>
                      
                        <li><a href="https://accu.org/reviews/by_author/">Reviews by Author</a></li>
                      
                        <li><a href="https://accu.org/reviews/by_reviewer/">Reviews by Reviewer</a></li>
                      
                        <li><a href="https://accu.org/reviews/by_publisher/">Reviews by Publisher</a></li>
                      
                        <li><a href="https://accu.org/reviews/by_rating/">Reviews by Rating</a></li>
                      
                    </ul>
                    
                  </li>
                  
                  
                  <li class="dropdown">
                    
                    <a href="https://accu.org/menu-overviews/local-groups/">Local Groups</a>
                    
                  </li>
                  
                  
                  <li class="dropdown">
                    
                    <a href="https://accu.org/menu-overviews/membership/">JOIN!</a>
                    
                  </li>
                  
                  
                  <li class="dropdown">
                    
                    <a href="https://accu.org/loginout/log-in/">Log In</a>
                    
                  </li>
                  
                </ul>
            </div>
            

            <div class="collapse clearfix" id="search">

                <form class="navbar-form" role="search">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Search">
                        <span class="input-group-btn">

                    <button type="submit" class="btn btn-template-main"><i class="fas fa-search"></i></button>

                </span>
                    </div>
                </form>

            </div>
            

        </div>
    </div>
    

</div>




        </header>

        
    <div id="heading-breadcrumbs">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                        <h1>Implementing Type-Classes as OCaml Modules</h1>
                </div>
            </div>
        </div>
    </div>



        <div id="content">

            <div class="container">

                <div class="row">

                    <div class="col-md-10">

                        <div class="row">
                            <div class="col-md-12">
                                <p><b>Implementing Type-Classes as OCaml Modules</b></p>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-12">
                                <p>By Shayne Fletcher</p>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-12">
                                <p><i>Overload, 25(142):11-13, December 2017</i></p>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-12">
                                <hr class="accu">
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-12">

                                <div>
                                    <div class="article-content">
<div class="article-summary">
<p>Type classes achieve overloading in functional paradigms. Shayne Fletcher implements some as OCaml modules.</p>
</div>

<h2>
 Modular type classes
</h2>

<p>
 In this article, we revisit the idea of type-classes first explored in a previous blog post [
 <a href="#[Fletcher16a]">
  Fletcher16a
 </a>
 ]. This time though, the implementation technique will be by via OCaml modules inspired by the paper ‘Modular Type Classes’ [
 <a href="#[Dreyer07]">
  Dreyer07
 </a>
 ] by Dreyer
 <em>
  et al
 </em>
 .
</p>

<table class="sidebartable">
 <tbody><tr>
  <td class="title">
   Ad hoc polymorphism
  </td>
 </tr>
 <tr>
  <td>
   <table class="journaltable">
    <tbody><tr>
     <td>
      <p>
       In programming languages, there is a particular kind of 
polymorphism known formally called ad hoc polymorphism but better known 
as overloading. For example with overloading, an operator like + may be 
defined that works for many different kinds of numbers.
      </p>
      <p>
       In the programming language Haskell, a language construction called
       <em>
        type classes
       </em>
       provides a structured way to provide for ad hoc polymorphism. The
 OCaml programming language does not have type
classes but rather provides a construction called modules. Ad hoc 
polymorphism via Haskell-like typeclass style programming can be 
supported in OCaml by viewing type classes as a particular mode of use 
of modules. Indeed, the module approach can be argued as better in the 
sense that programmers can have explicit control over which type class
instances are available in a given scope.
      </p>
     </td>
    </tr>
   </tbody></table>
  </td>
 </tr>
</tbody></table>

<p>
 Starting with the basics, consider the class of types whose values can be compared for equality. Call this type-class
 <code>
  Eq
 </code>
 . We represent the class as a module signature.
</p>

<pre class="programlisting">  module type EQ = sig
    type t
    val eq : t * t → bool
  end</pre>

<p>
 Specific instances of
 <code>
  Eq
 </code>
 are modules that implement this signature. Here are two examples.
</p>

<pre class="programlisting">  module Eq_bool : EQ with type t = bool = struct
    type t = bool
    let eq (a, b) = a = b
  end
  module Eq_int : EQ with type t = int = struct
    type t = int
    let eq (a, b) = a = b
  end</pre>

<p>
 Given instances of class
 <code>
  Eq
 </code>
 (
 <code>
  X
 </code>
 and
 <code>
  Y
 </code>
 say,) we realize that products of those instances are also in
 <code>
  Eq
 </code>
 . This idea can be expressed as a functor with the following type.
</p>

<pre class="programlisting">  module type EQ_PROD =
    functor (X : EQ) (Y : EQ) → 
      EQ with type t = X.t * Y.t</pre>

<p>
 The implementation of this functor is simply stated as the following.
</p>

<pre class="programlisting">  module Eq_prod : EQ_PROD =
    functor (X : EQ) (Y : EQ) → struct
      type t = X.t * Y.t
      let eq ((x1, y1), (x2, y2)) 
        = X.eq (x1, x2) &amp;&amp; Y.eq(y1, y2)
  end</pre>

<p>
 With this functor we can build concrete instances for products. Here‘s one example.
</p>

<pre class="programlisting">  module Eq_bool_int : 
    EQ with type t = (bool * int) 
      = Eq_prod (Eq_bool) (Eq_int)</pre>

<p>
 The class
 <code>
  Eq
 </code>
 can be used as a building block for the construction of new type classes. For example, we might define a new type-class
 <code>
  Ord
 </code>
 that admits types that are equality comparable and whose values can be 
ordered with a ‘less-than’ relation. We introduce a new module type to 
describe this class.
</p>

<pre class="programlisting">  module type ORD = sig
    include EQ
    val lt : t * t → bool
  end</pre>

<p>
 Here’s an example instance of this class.
</p>

<pre class="programlisting">  module Ord_int : ORD with type t = int = struct
    include Eq_int
    let lt (x, y) = Pervasives.( &lt; ) x y
  end</pre>

<p>
 As before, given two instances of this class, we observe that products 
of these instances also reside in the class. Accordingly, we have this 
functor type
</p>

<pre class="programlisting">  module type ORD_PROD =
    functor (X : ORD) (Y : ORD) → ORD with type t 
      = X.t * Y.t</pre>

<p>
 with the following implementation.
</p>

<pre class="programlisting">  module Ord_prod : ORD_PROD =
    functor (X : ORD) (Y : ORD) → struct
      include Eq_prod (X) (Y)
      let lt ((x1, y1), (x2, y2)) =
        X.lt (x1, x2) || X.eq (x1, x2) &amp;&amp; 
        Y.lt (y1, y2)
  end</pre>

<p>
 This is the corresponding instance for pairs of integers.
</p>

<pre class="programlisting">  module Ord_int_int = Ord_prod (Ord_int) (Ord_int)</pre>

<p>
 Here’s a simple usage example.
</p>

<pre class="programlisting">  let test_ord_int_int = 
    let x = (1, 2) and y = (1, 4) in
    assert ( not (Ord_int_int.eq (x, y)) &amp;&amp; 
      Ord_int_int.lt (x, y))</pre>

<h2>
 Using type-classes to implement parametric polymorphism
</h2>

<p>
 This section begins with the
 <code>
  Show
 </code>
 type-class.
</p>

<pre class="programlisting">  module type SHOW = sig
    type t
    val show : t → string
  end</pre>

<p>
 In what follows, it is convenient to make an alias for module values of this type.
</p>

<pre class="programlisting">  type 'a show_impl = (module SHOW with type t = 'a)</pre>

<p>
 Here are two instances of this class...
</p>

<pre class="programlisting">  module Show_int : SHOW with type t = int = struct
    type t = int
    let show = Pervasives.string_of_int
  end
  module Show_bool : SHOW with type t = bool 
      = struct
    type t = bool
    let show = function | true → "True" 
      | false → "False"
  end</pre>

<p>
 ...and here these instances are ‘packed’ as values:
</p>

<pre class="programlisting">  let show_int : int show_impl = 
    (module Show_int : SHOW with type t = int)
  let show_bool : bool show_impl = 
    (module Show_bool : SHOW with type t = bool)</pre>

<p>
 The existence of the
 <code>
  Show
 </code>
 class is all that is required to enable the writing of our first parametrically polymorphic function.
</p>

<pre class="programlisting">  let print : 'a show_impl → 'a → unit =
    fun (type a) (show : a show_impl) (x : a) →
    let module Show = 
      (val show : SHOW with type t = a) in
    print_endline@@ Show.show x
  let test_print_1 : unit = print show_bool true
  let test_print_2 : unit = print show_int 3</pre>

<p>
 The function
 <code>
  print
 </code>
 can be used with values of any type
 <code>
  'a
 </code>
 as long as the caller can produce evidence of
 <code>
  'a
 </code>
 ’s membership in
 <code>
  Show
 </code>
 (in the form of a compatible instance).
</p>

<p>
 Listing 1 begins with the definition of a type-class
 <code>
  Num
 </code>
 (the class of additive numbers) together with some example instances.
</p>

<table class="sidebartable">
 <tbody><tr>
  <td>
   <pre class="programlisting">module type NUM = sig
  type t
  val from_int : int → t
  val ( + ) : t → t → t
end

type 'a num_impl = (module NUM with type t = 'a)

module Num_int : NUM with type t = int = struct
  type t = int
  let from_int x = x
  let ( + ) = Pervasives.( + )
end
    
let num_int = (module Num_int : NUM with 
  type t = int)

module Num_bool : NUM with type t = bool = struct
  type t = bool

  let from_int = function | 0 → false 
    | _ → true
  let ( + ) = function | true → fun _ → true 
    | false → fun x → x
end
  
let num_bool = 
  (module Num_bool : NUM with type t = bool)
			</pre>
  </td>
 </tr>
 <tr>
  <td class="title">
   Listing 1
  </td>
 </tr>
</tbody></table>

<p>
 The existence of
 <code>
  Num
 </code>
 admits writing a polymorphic function
 <code>
  sum
 </code>
 that will work for any
 <code>
  'a list
 </code>
 of values if only
 <code>
  'a
 </code>
 can be shown to be in
 <code>
  Num
 </code>
 .
</p>

<pre class="programlisting">  let sum : 'a num_impl → 'a list → 'a =
    fun (type a) (num : a num_impl) (ls : a list) →
      let module Num = 
        (val num : NUM with type t = a) in
      List.fold_right Num.( + ) ls (Num.from_int 0)
  let test_sum = sum num_int [1; 2; 3; 4]</pre>

<p>
 This next function requires evidence of membership in two classes.
</p>

<pre class="programlisting">  let print_incr : ('a show_impl * 'a num_impl)
      → 'a → unit =
    fun (type a) ((show : a show_impl),
      (num : a num_impl)) (x : a) →
      let module Num = 
        (val num : NUM with type t = a) in
      let open Num
      in print show (x + from_int 1)
  (*An instantiation*)
  let print_incr_int (x : int) : unit 
    = print_incr (show_int, num_int) x</pre>

<p>
 If
 <code>
  'a
 </code>
 is in
 <code>
  Show
 </code>
 then we can easily extend
 <code>
  Show
 </code>
 to include the type
 <code>
  'a list
 </code>
 . As we saw earlier, this kind of thing can be done with an appropriate functor. (See Listing 2.)
</p>

<table class="sidebartable">
 <tbody><tr>
  <td>
   <pre class="programlisting">module type LIST_SHOW =
  functor (X : SHOW) → 
    SHOW with type t = X.t list

  module List_show : LIST_SHOW =
    functor (X : SHOW) → struct
      type t = X.t list
    
      let show =
        fun xs →
          let rec go first = function
            | [] → "]"
            | h :: t →
              (if (first) then "" else ", ") 
               ^ X.show h ^ go false t 
          in "[" ^ go true xs
    end
			</pre>
  </td>
 </tr>
 <tr>
  <td class="title">
   Listing 2
  </td>
 </tr>
</tbody></table>

<p>
 There is also another way: one can write a function to dynamically compute an
 <code>
  'a list
 </code>
 <code>
  show_impl
 </code>
 from an
 <code>
  'a show_impl
 </code>
 (see Listing 3).
</p>

<table class="sidebartable">
 <tbody><tr>
  <td>
   <pre class="programlisting">let show_list : 'a show_impl → 'a list show_impl
   = fun (type a) (show : a show_impl) →
    let module Show = 
      (val show : SHOW with type t = a) in
    (module struct
      type t = a list
      let show : t → string =
        fun xs →
          let rec go first = function
            | [] → "]"
            | h :: t →
              (if (first) then "" else ", ") 
                 ^ Show.show h ^ go false t
          in "[" ^ go true xs
    end : SHOW with type t = a list)

let testls : string = let module Show =
  (val (show_list show_int) 
  : SHOW with type t = int list) in
  Show.show (1 :: 2 :: 3 :: [])
			</pre>
  </td>
 </tr>
 <tr>
  <td class="title">
   Listing 3
  </td>
 </tr>
</tbody></table>

<p>
 The type-class
 <code>
  Mul
 </code>
 is an aggregation of the type-classes
 <code>
  Eq
 </code>
 and
 <code>
  Num
 </code>
 together with a function to perform multiplication. (Listing 4.)
</p>

<table class="sidebartable">
 <tbody><tr>
  <td>
   <pre class="programlisting">module type MUL = sig
  include EQ
  include NUM with type t := t

  val mul : t → t → t
end

type 'a mul_impl = (module MUL with type t = 'a)

module type MUL_F =
   functor (E : EQ) (N : NUM with type t = E.t) 
   → MUL with type t = E.t
			</pre>
  </td>
 </tr>
 <tr>
  <td class="title">
   Listing 4
  </td>
 </tr>
</tbody></table>

<p>
 A default instance of
 <code>
  Mul
 </code>
 can be provided given compatible instances of
 <code>
  Eq
 </code>
 and
 <code>
  Num
 </code>
 . (See Listing 5.)
</p>

<table class="sidebartable">
 <tbody><tr>
  <td>
   <pre class="programlisting">module Mul_default : MUL_F =
  functor (E : EQ) (N : NUM with type t = E.t)  
      → struct
    include (E : EQ with type t = E.t)
    include (N : NUM with type t := E.t)

    let mul : t → t → t =
      let rec loop x y = begin match () with
         | () when eq (x, (from_int 0)) 
           → from_int 0
         | () when eq (x, (from_int 1)) → y
         | () → y + loop (x + (from_int (-1))) y
       end in loop
end

module Mul_bool : MUL with type t = bool = 
  Mul_default (Eq_bool) (Num_bool)   
			</pre>
  </td>
 </tr>
 <tr>
  <td class="title">
   Listing 5
  </td>
 </tr>
</tbody></table>

<p>
 Specific instances can be constructed as needs demand (Listing 6).
</p>

<table class="sidebartable">
 <tbody><tr>
  <td>
   <pre class="programlisting">module Mul_int : MUL with type t = int = struct
  include (Eq_int : EQ with type t = int)
  include (Num_int : NUM with type t := int)
  let mul = Pervasives.( * )
end
    
let dot : 'a mul_impl → 'a list → 'a list → 'a
  = fun (type a) (mul : a mul_impl) →
    fun xs ys →
      let module M = 
        (val mul : MUL with type t = a) in
      sum (module M : NUM with type t = a)
        @@ List.map2 M.mul xs ys
let test_dot =
  dot (module Mul_int : MUL with type t = int) 
    [1; 2; 3] [4; 5; 6]
			</pre>
  </td>
 </tr>
 <tr>
  <td class="title">
   Listing 6
  </td>
 </tr>
</tbody></table>

<p>
 Note that in this definition of
 <code>
  dot
 </code>
 , coercion of the provided
 <code>
  Mul
 </code>
 instance to its base
 <code>
  Num
 </code>
 instance is performed.
</p>

<p>
 Listing 7 provides an example of polymorphic recursion utilizing the dynamic production of evidence by way of the
 <code>
  show_list
 </code>
 function presented earlier.
</p>

<table class="sidebartable">
 <tbody><tr>
  <td>
   <pre class="programlisting">let rec replicate : int → 'a → 'a list =
  fun n x → if n &lt;= 0 
    then [] else x :: replicate (n - 1) x
let rec print_nested : 'a. 'a show_impl → 
  int → 'a → unit = fun show_mod → function
  | 0 → fun x → print show_mod x
  | n → fun x → print_nested 
    (show_list show_mod) (n - 1) (replicate n x)
let test_nested =
  let n = read_int () in
  print_nested (module Show_int : SHOW 
  with type t = int) n 5
			</pre>
  </td>
 </tr>
 <tr>
  <td class="title">
   Listing 7
  </td>
 </tr>
</tbody></table>

<p class="EditorIntro">
 This article was previously published as a blog post in 2016. [
 <a href="#[Fletcher16b]">
  Fletcher16b
 </a>
 ] and the source is available at:
 <a href="https://github.com/shayne-fletcher/overload-2017/blob/master/mod.ml">
  https://github.com/shayne-fletcher/overload-2017/blob/master/mod.ml
 </a>
</p>

<h2>
 References
</h2>

<p class="bibliomixed">
 <a id="[Dreyer07]">
 </a>
 [Dreyer07] Derek Dreyer, Robert Harper and Manuel M. T. Chakravarty, ‘Modular Type Classes’, 2007, available online at
 <a href="http://www.cse.unsw.edu.au/~chak/papers/mtc-popl.pdf">
  http://www.cse.unsw.edu.au/~chak/papers/mtc-popl.pdf
 </a>
</p>

<p class="bibliomixed">
 <a id="[Fletcher16a]">
 </a>
 [Fletcher16a] Shayne Fletcher, ‘Haskell type-classes in OCaml and C++’, available at
 <a href="http://blog.shaynefletcher.org/2016/10/haskell-type-classes-in-ocaml-and-c.html">
  http://blog.shaynefletcher.org/2016/10/haskell-type-classes-in-ocaml-and-c.html
 </a>
</p>

<p class="bibliomixed">
 <a id="[Fletcher16b]">
 </a>
 [Fletcher16b] Shayne Fletcher, ‘Implementing type-classes as OCaml modules’, available at
 <a href="http://blog.shaynefletcher.org/2016/10/implementing-type-classes-as-ocaml.html">
  http://blog.shaynefletcher.org/2016/10/implementing-type-classes-as-ocaml.html
 </a>
</p>

<p class="bibliomixed">
 <a id="[Kiselyov14]">
 </a>
 [Kiselyov14] Oleg Kiselyov, ‘Implementing, and Understanding Type Classes’, updated November 2014, available at
 <a href="http://okmij.org/ftp/Computation/typeclass.html">
  http://okmij.org/ftp/Computation/typeclass.html
 </a>
</p>

</div>
                                    <br>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div class="col-md-2">

                        <div class="panel panel-default sidebar-menu">

    <div class="panel-heading" align="center">
      <h5 class="panel-title">Advertisement</h5>
    </div>

    <div class="panel-body" align="center">

        <a href="https://ads.accu.org/www/delivery/ck.php?n=ac1df087&amp;cb=879648978587659" target="_blank">
           <img src="Implementing%20Type-Classes%20as%20OCaml%20Modules_files/79b55eb8633e531e047ea9bd5ce49d89.png" alt="" border="0"></a>

    </div>
</div>


<br>

<div class="panel panel-default sidebar-menu">

    <div class="panel-body" align="center">

        <a href="https://accu.org/menu-overviews/membership/"><img src="Implementing%20Type-Classes%20as%20OCaml%20Modules_files/join.png"></a>

    </div>
</div>


<br>






<br>








                    </div>
                </div>
            </div>
        </div>

        <style>
  .dropbtn {
    background: #555555;
    color: #38a7bb;
    padding: 0px;
    border: none;
  }
  
  .dropdown {
    position: relative;
    display: inline-block;
  }
  
  .dropdown-content {
    display: none;
    padding: 16px;
  }
  
  .dropdown-content a {
    display: block
  }
  
  .dropdown-content a:hover {background-color: #ddd;}
  
  .dropdown:hover .dropdown-content {display: block;}
  
  .dropdown:hover .dropbtn {background-color: #555555;}
</style>
  

<footer id="footer">
    <div class="container">

        <div class="col-md-2 col-sm-2">
            <h4>FAQ:</h4>
            <a href="https://accu.org/faq/about"> About Us            </a><br>
            <a href="https://accu.org/faq/what-is"> What is ACCU?       </a><br>
            <a href="https://accu.org/faq/advertise"> Advertise with ACCU </a><br>
            <a href="https://accu.org/faq/conference"> Conferences         </a><br>
            <a href="https://accu.org/faq/short-committee"> Committee Members   </a><br>
            <a href="https://accu.org/faq/constitution"> Constitution        </a><br>
            <a href="https://accu.org/faq/values"> Values              </a><br>
            <a href="https://accu.org/faq/study-groups-faq"> Study Groups        </a><br>
            <a href="https://accu.org/faq/mailing-lists-faq"> Mailing Lists       </a><br>
            <a href="https://accu.org/faq/privacy-policy"> Privacy Policy      </a>

            <hr class="hidden-md hidden-lg hidden-sm">
        </div>

        <div class="col-md-3 col-sm-3">
            <h4>Members Only:</h4>
            <a href="https://accu.org/members/study-groups"> Study Groups            </a><br>
            <a href="https://accu.org/members/mailing-lists"> Mailing Lists           </a><br>
            <a href="https://accu.org/members/review-a-book"> Review a Book           </a><br>

            <div class="dropdown">
              <button class="dropbtn"> ACCU Committee</button>
              <div class="dropdown-content" style="min-width:max-content">
                <a href="https://accu.org/members/long-committee"> Committee Members  </a>
                <a href="https://accu.org/members/posts-and-roles"> Posts and Roles    </a>
                <a href="https://accu.org/members/attending-meetings"> Attending Meetings </a>
                <a href="https://accu.org/members/minutes"> Minutes            </a>
                <a href="https://accu.org/members/archive"> Archive            </a>
              </div>
            </div>
            
            <br>
            <a href="https://accu.org/members/agm"> Annual General Meetings </a><br>
            <a href="https://accu.org/members/complaints"> Complaints Procedure    </a><br>

            <div class="dropdown">
              <button class="dropbtn"> Membership Updates</button>
              <div class="dropdown-content" style="min-width:max-content">
                  <a href="https://accu.org/actions/display-details"> Update Member Details </a>
                  <a href="https://accu.org/actions/change-password"> Update Password       </a>
                  <a href="https://accu.org/members/member-updates"> Other Member Updates  </a>
              </div>
            </div>

            <br>
            <a href="https://accu.org/loginout/log-out"> Log Out </a>

            <hr class="hidden-md hidden-lg hidden-sm">
        </div>

        <div class="col-md-2 col-sm-2">

            <h4>Contact:</h4>
            <a href="mailto:info@accu.org?subject=[ACCU]"> General Information </a><br>
            <a href="mailto:accumembership@accu.org?subject=[ACCU]"> Membership          </a><br>
            <a href="mailto:local-groups@accu.org?subject=[ACCU]"> Local Groups        </a><br>
            <a href="mailto:ads@accu.org?subject=[ACCU]"> Advertising         </a><br>
            <a href="mailto:webmaster@accu.org?subject=[ACCU]"> Web Master          </a><br>
            <a href="mailto:webeditor@accu.org?subject=[ACCU]"> Web Editor          </a><br>
            <a href="mailto:conference@accu.org?subject=[ACCU]"> Conference          </a>

            <hr class="hidden-md hidden-lg hidden-sm">
        </div>

        <div class="col-md-2 col-sm-2">

          <h4>Links:</h4>
          <a href="https://blogs.accu.org/"> World of Code   </a><br>
          <a href="https://github.com/accu-org/essential-books/wiki"> Essential Books </a><br>
          <a href="https://www.twitter.com/accuorg"> Twitter         </a><br>
          <a href="https://www.facebook.com/accuorg"> Facebook        </a><br>
          <a href="https://www.linkedin.com/company/accu/"> LinkedIn        </a><br>
          <a href="https://www.github.com/accu-org"> GitHub          </a><br>
          <a href="https://www.flickr.com/groups/accu-org"> flickr          </a><br>
          <a href="https://www.youtube.com/channel/UCJhay24LTpO1s4bIZxuIqKw"> YouTube         </a><br>
          <a href="https://accu.org/index.xml"> RSS Feed        </a>

          <hr class="hidden-md hidden-lg hidden-sm">
      </div>

      <div class="col-md-3 col-sm-3">
            <h4>Buttons for your website:</h4>

            <a href="https://accu.org/img/accu/button-logo-120x32.png" title="ACCU: professionalism in programming (120x32 px)" download="">
            <img src="Implementing%20Type-Classes%20as%20OCaml%20Modules_files/button-logo-120x32.png" alt="ACCU: professionalism in programming (120x32 px)">
            </a><br>
            
            <a href="https://accu.org/img/accu/button-logo-225x60.png" title="ACCU: professionalism in programming (225x60 px)" download="">
            <img src="Implementing%20Type-Classes%20as%20OCaml%20Modules_files/button-logo-225x60.png" alt="ACCU: professionalism in programming (225x60 px)">
            </a>
          
          </div>
    </div>
</footer>





<div id="copyright">
    <div class="container">
      <div class="row">
        <div class="col-md-4">
            
               <p class="pull-left">Copyright (c) 2018-2022 ACCU; all rights reserved.</p>
            
        </div>

        <div class="col-md-4">
            <p>
              </p><h5 class="panel-title" align="center">Advertisement</h5>
            <p></p>
            <p>
              <a href="https://ads.accu.org/www/delivery/ck.php?n=a7cc1ec0&amp;cb=78725481">
                <img src="Implementing%20Type-Classes%20as%20OCaml%20Modules_files/bbdb738d7068b251012b782595d7e30e.jpg">
              </a>
            </p>
        </div>

        <div class="col-md-4">
            <p class="pull-right">
              Template by <a href="https://bootstrapious.com/p/universal-business-e-commerce-template">Bootstrapious</a>.
              
            </p>

            <br>

            <p class="pull-right">
              Ported to Hugo by <a href="https://github.com/devcows/hugo-universal-theme">DevCows</a>.
            </p>

            <br>

            <p class="pull-right">
              Customized for ACCU by Jim and Bob.
            </p>

            <br>

            <p class="pull-right">
              Hosting provided by <a href="http://www.bytemark.co.uk/">Bytemark</a>.
            </p>
        </div>

      </div>
    </div>
</div>





    </div>

    
<script src="Implementing%20Type-Classes%20as%20OCaml%20Modules_files/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
<script src="Implementing%20Type-Classes%20as%20OCaml%20Modules_files/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<script src="Implementing%20Type-Classes%20as%20OCaml%20Modules_files/jquery.cookie.min.js"></script>
<script src="Implementing%20Type-Classes%20as%20OCaml%20Modules_files/jquery.waypoints.min.js"></script>
<script src="Implementing%20Type-Classes%20as%20OCaml%20Modules_files/jquery.counterup.min.js"></script>
<script src="Implementing%20Type-Classes%20as%20OCaml%20Modules_files/jquery-parallax.js"></script>

<script src="Implementing%20Type-Classes%20as%20OCaml%20Modules_files/front.js"></script>


<script src="Implementing%20Type-Classes%20as%20OCaml%20Modules_files/owl.carousel.min.js"></script>



  
</body></html>